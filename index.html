<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>SuperWin ‚Äì Crash Game</title>

<!-- Font‚Äëawesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
:root{--accent:#00ffcc;--danger:#ff4040;--bg:#1d2033}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif}
body{background:#0d0f1a;color:#fff;display:flex;flex-direction:column}

/* header */
header{background:#1a1e2f;padding:12px 20px;display:flex;justify-content:space-between;align-items:center;border-bottom:2px solid #292c3f}
h1{font-size:22px;color:#00d4ff;display:flex;align-items:center;gap:6px}
.wallet{display:flex;align-items:center;gap:10px}
.wallet span{background:#2d3149;padding:6px 12px;border-radius:8px;font-size:14px}
.wallet button{background:#00d4ff;color:#000;border:none;padding:6px 10px;border-radius:8px;font-weight:600;cursor:pointer}

/* result bar */
.result-wrap{position:relative;padding:8px 0}
.history-icon{position:absolute;right:12px;top:50%;transform:translateY(-50%);font-size:14px;cursor:pointer;color:#ccc}
.result-bar{display:flex;gap:6px;justify-content:center;flex-direction:row-reverse}       /* ‡¶°‡¶æ‡¶® ‡¶¶‡¶ø‡¶ï ‡¶•‡ßá‡¶ï‡ßá ‡¶¢‡ßã‡¶ï‡ßá */
.bubble{min-width:32px;padding:3px 6px;border-radius:6px;font-size:11px;font-weight:600;text-align:center}
.good{background:#28a745}.mid{background:#ffc107}.bad{background:#dc3545}
.dropdown{margin-top:6px;display:none;flex-wrap:wrap;gap:6px;justify-content:center;max-height:110px;overflow:auto}
.open .dropdown{display:flex}

/* main card */
.card{width:95vw;max-width:480px;margin:0 auto;background:var(--bg);padding:18px;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,.4)}
.runway{position:relative;width:100%;height:80px;border-radius:12px;overflow:hidden;margin-bottom:12px}
.runway::before{content:"";position:absolute;inset:0;background:url('https://drive.google.com/uc?export=view&id=10oYzjF5-tJEY7rychqkg2rksF5n23XOz') center/200% 100% repeat-x;filter:brightness(.8);animation:bgmove 12s linear infinite}
@keyframes bgmove{to{background-position:-100% 0}}
.plane{position:absolute;left:0;top:50%;transform:translateY(-50%);font-size:40px;filter:drop-shadow(0 0 6px var(--accent));transition:left .05s linear}
.bob{animation:bob .8s ease-in-out infinite}@keyframes bob{0%,100%{transform:translateY(-50%) translateY(-3px)}50%{transform:translateY(-50%) translateY(4px)}}
.shake{animation:shake .6s}@keyframes shake{10%,90%{transform:translateY(-50%) rotate(-4deg)}20%,80%{transform:translateY(-50%) rotate(4deg)}30%,70%{transform:translateY(-50%) rotate(-7deg)}40%,60%{transform:translateY(-50%) rotate(7deg)}50%{transform:translateY(-50%) rotate(0)}}
.boom{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-size:3rem;filter:drop-shadow(0 0 12px var(--danger));opacity:0;animation:boom .6s forwards}
@keyframes boom{0%{opacity:0;transform:translate(-50%,-50%) scale(.4)}50%{opacity:1;transform:translate(-50%,-50%) scale(1.3)}100%{opacity:0;transform:translate(-50%,-50%) scale(.2)}}
.mult{font-size:2.4rem;text-align:center;color:var(--accent);margin:4px 0;text-shadow:0 0 12px var(--accent)}
.speedBar{width:100%;height:16px;background:#222;border:2px solid #555;border-radius:10px;overflow:hidden;margin-bottom:6px}
.fill{width:0;height:100%;background:hsl(240,100%,55%);transition:width .1s linear,background .1s linear}

/* hide legacy timer */
.timer{display:none}

.bet-history{font-size:10px;margin-top:8px;text-align:center}

/* bet zone */
.bet-zone{margin:18px auto;width:95vw;max-width:480px;display:flex;gap:12px}
.bet-card{background:#1a1a2a;padding:10px;border-radius:12px;flex:1 1 40%;display:flex;flex-direction:column;gap:6px;font-size:12px}
.bet-card input{background:#243544;border:none;padding:6px;border-radius:6px;color:#fff;font-size:12px;width:100%}
.bet-btn{padding:6px;border:none;border-radius:6px;background:var(--accent);color:#000;font-weight:600;cursor:pointer}
.bet-btn:disabled{opacity:.45;cursor:not-allowed}
.quick{display:flex;gap:4px}
.quick button{flex:1;background:#333;font-size:11px;padding:4px;color:#fff;border:none;border-radius:5px}

/* history tabs */
.history-tabs{width:95vw;max-width:480px;margin:0 auto 20px;background:#16202c;border-radius:12px;overflow:hidden}
.tab-header{display:flex}
.tab-btn{flex:1;background:#1f2b39;color:#aaa;font-size:12px;padding:8px 0;border:none;cursor:pointer}
.tab-btn.active{background:#00d4ff;color:#000;font-weight:600}
.tab-body{background:#101822;max-height:150px;overflow-y:auto}
.tab-content{display:none;padding:8px 10px;font-size:12px;line-height:16px}
.tab-content.active{display:block}
.entry{display:flex;justify-content:space-between;margin-bottom:4px}
.win{color:#00ff7b}.loss{color:#ff7373}

/* toast */
.toast{position:fixed;left:50%;bottom:48px;transform:translateX(-50%) translateY(40px);background:#0d121e;border:2px solid #00d4ff;border-radius:10px;padding:10px 18px;opacity:0;pointer-events:none;font-size:14px;font-weight:600;transition:opacity .35s,transform .35s}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

@media(max-width:430px){.mult{font-size:1.9rem}.plane{font-size:34px}}
</style>
</head>
<body>

<header>
  <h1><i class="fa-solid fa-plane-up"></i>&nbsp;SuperWin</h1>
  <div class="wallet">‡ß≥<span id="bal">0</span><button id="dep">Cancel</button></div>
</header>

<!-- RESULT BAR -->
<div class="result-wrap">
  <div class="history-icon" id="histToggle"><i class="fas fa-history"></i></div>
  <div class="result-bar" id="resBar"></div>
  <div class="dropdown" id="resDrop"></div>
</div>

<!-- MAIN CARD -->
<div class="card">
  <div class="runway" id="runway"><div class="plane" id="plane">‚úàÔ∏è</div></div>
  <div class="mult" id="mult">x1.00</div>
  <div class="speedBar"><div class="fill" id="fill"></div></div>
  <div class="timer" id="timer"><i class="fas fa-hourglass-half"></i><span id="tLeft">10.0</span>s</div>
  <div class="bet-history" id="betHist">Total Cash‚Äëout: ‡ß≥0 | Total Bet: ‡ß≥0</div>
</div>

<!-- BET ZONE -->
<div class="bet-zone">
  <div class="bet-card">
    Amount <input id="amt1" type="number" placeholder="‡ß≥">
    Auto  <input id="auto1" type="number" placeholder="x">
    <div class="quick"><button data-val="10">+10</button><button data-val="50">+50</button><button data-val="100">+100</button></div>
    <button class="bet-btn" data-idx="0">BET</button>
  </div>
  <div class="bet-card">
    Amount <input id="amt2" type="number" placeholder="‡ß≥">
    Auto  <input id="auto2" type="number" placeholder="x">
    <div class="quick"><button data-val="10">+10</button><button data-val="50">+50</button><button data-val="100">+100</button></div>
    <button class="bet-btn" data-idx="1">BET</button>
  </div>
</div>

<!-- HISTORY TABS -->
<div class="history-tabs">
  <div class="tab-header">
    <button class="tab-btn active" data-tab="playerTab">Player History</button>
    <button class="tab-btn" data-tab="myTab">My Bet History</button>
  </div>
  <div class="tab-body">
    <div id="playerTab" class="tab-content active"></div>
    <div id="myTab" class="tab-content"></div>
  </div>
</div>

<!-- Toast -->
<div class="toast" id="toast">Place your bets!</div>

<!-- === Firebase SDK (compat) === -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

<script>
/* ---------- Firebase Init ---------- */
const firebaseConfig = {
  apiKey: "AIzaSyDVaI_YjkGUrpzqZG6SqY6Y0VmO7SkK7ew",
  authDomain: "aviator-ultimate.firebaseapp.com",
  databaseURL: "https://aviator-ultimate-default-rtdb.firebaseio.com",
  projectId: "aviator-ultimate",
  storageBucket: "aviator-ultimate.firebasestorage.app"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* ---------- Simple auth (anonymous) ---------- */
let uid=null,userName=null;
firebase.auth().signInAnonymously().catch(console.error);
firebase.auth().onAuthStateChanged(u=>{
  if(!u) return;
  uid=u.uid;
  userName = 'üë§'+uid.slice(0,2)+'******'+uid.slice(-2);
  initGame();     // ‡¶∏‡¶¨ ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§‡¶ø ‡¶∂‡ßá‡¶∑‡ßá ‡¶ó‡ßá‡¶Æ ‡¶ö‡¶æ‡¶≤‡ßÅ
});
</script>

<!-- === GAME CORE === -->
<script>
function initGame(){
/* ---------- Elements ---------- */
const balEl=document.getElementById('bal'),dep=document.getElementById('dep');
const resBar=document.getElementById('resBar'),resDrop=document.getElementById('resDrop'),histToggle=document.getElementById('histToggle');
const plane=document.getElementById('plane'),fill=document.getElementById('fill'),multEl=document.getElementById('mult');
const timer=document.getElementById('timer'),tLeft=document.getElementById('tLeft'),betHist=document.getElementById('betHist');
const amtInputs=[document.getElementById('amt1'),document.getElementById('amt2')];
const autoInputs=[document.getElementById('auto1'),document.getElementById('auto2')];
const playerTab=document.getElementById('playerTab'),myTab=document.getElementById('myTab');
const toast=document.getElementById('toast');
const betBtns=[...document.querySelectorAll('.bet-btn')];

/* Quick add buttons */
document.querySelectorAll('.quick button').forEach(b=>b.onclick=()=>{
  const i=b.closest('.bet-card').querySelector('input');
  i.value=(+i.value||0)+ +b.dataset.val;
});

/* Tab switch */
document.querySelectorAll('.tab-btn').forEach(btn=>btn.onclick=()=>{
  document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
  btn.classList.add('active');document.getElementById(btn.dataset.tab).classList.add('active');
});

/* ---------- Game vars ---------- */
let targetRTP=0.8,minBet=5,maxBet=10000;
let wallet=0,totalBet=0,totalPaid=0;
let history=[],bets=[{amt:0,auto:0,cashed:false},{amt:0,auto:0,cashed:false}];
let lastAmt=[0,0],lastAuto=[0,0];
let phase='IDLE',count=100,startT,crashPt,mult=1,speed=0,animId;
let fakePlayers=[],curBet=0,curCash=0;

/* ---------- Firebase helpers ---------- */
const userRef = db.ref('users/'+uid);
const walletRef = userRef.child('points');
walletRef.on('value',snap=>{
  wallet=+snap.val()||0;updWallet();
});
db.ref('config/rtp').on('value',s=>{targetRTP=+s.val()||0.8;});
const feedRef=db.ref('feed');           // ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤‡¶ü‡¶æ‡¶á‡¶Æ ‡¶´‡¶ø‡¶°

/* ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶ì ‡¶∂‡ßã‡¶®‡¶æ */
feedRef.limitToLast(50).on('child_added',snap=>{
  const e=snap.val();
  if(!e) return;
  if(e.type==='bet') addEntry(playerTab,`${e.name} ‚Äî üé≤ Bet ‡ß≥${e.amt}`);
  if(e.type==='cash') addEntry(playerTab,`${e.name} ‚Äî üí∞ ‡ß≥${e.win} @${e.mult}x`,'win');
  if(e.type==='lose') addEntry(playerTab,`${e.name} ‚Äî ‚ùå Lost ‡ß≥${e.amt}`,'loss');
});

/* ‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‚Äë‡¶≤‡¶æ‡¶á‡¶® ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® */
const sendFeed = obj => feedRef.push({...obj,ts:firebase.database.ServerValue.TIMESTAMP});

/* ---------- Helpers ---------- */
const rand=(a,b)=>Math.random()*(b-a)+a;
const hue=v=>240-(v/100)*240;
function setSpeed(v){fill.style.width=Math.min(v,100)+'%';fill.style.background=`hsl(${hue(v)},100%,55%)`;}
const updWallet=()=>balEl.textContent=wallet;
const cls=v=>v>=4?'good':v>=2?'mid':'bad';
function renderRes(){
  resBar.innerHTML=resDrop.innerHTML='';
  history.slice(-8).forEach(v=>resBar.insertAdjacentHTML('beforeend',`<div class="bubble ${cls(v)}">${v}x</div>`));
  [...history].slice(-20).reverse().forEach(v=>resDrop.insertAdjacentHTML('beforeend',`<div class="bubble ${cls(v)}">${v}x</div>`));
}
histToggle.onclick=()=>histToggle.parentElement.classList.toggle('open');
function addEntry(el,msg,cl=''){
  const box=el.parentElement,oldTop=box.scrollTop;
  el.insertAdjacentHTML('beforeend',`<div class="entry ${cl}">${msg}</div>`);
  while(el.children.length>300)el.firstChild.remove();
  box.scrollTop=oldTop;
}
function restoreInputs(){
  amtInputs.forEach((inp,i)=>inp.value=lastAmt[i]||'');
  autoInputs.forEach((inp,i)=>inp.value=lastAuto[i]||'');
}
function showToast(msg,dur=1800){
  toast.textContent=msg;toast.classList.add('show');
  setTimeout(()=>toast.classList.remove('show'),dur);
}

/* Mult countdown in place of multiplier */
function updateMultCountdown(){
  multEl.style.color='#ffcc00';
  multEl.innerHTML=`<i class="fas fa-hourglass-half"></i> ${(count/10).toFixed(1)}s`;
}

/* ---------- Cancel button (previously Deposit) ---------- */
dep.onclick=()=>showToast('Canceled!');

/* ---------- Fake players (local only, ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã) ---------- */
function genPlayers(){
  const n=Math.floor(rand(300,1000));
  fakePlayers=[];playerTab.innerHTML='';
  for(let i=0;i<n;i++){
    const num=Math.floor(rand(1111111111,9999999999)).toString();
    const name='üë§'+num.slice(0,2)+'******'+num.slice(-2),
          bet=Math.floor(rand(10,500)),
          target=rand(1.2,10).toFixed(2);
    fakePlayers.push({name,bet,target:+target,cash:false,betAdded:false});
  }
}

/* ---------- Button state helper ---------- */
function setBtn(i,state,val=0){
  const b=betBtns[i];
  if(state==='bet'){b.textContent='BET';b.disabled=false;}
  if(state==='cancel'){b.textContent='CANCEL';b.disabled=false;}
  if(state==='wait'){b.textContent='CASH OUT';b.disabled=false;}
  if(state==='live'){b.textContent=`CASH ‡ß≥${val}`;}
  if(state==='done'){b.textContent='BET';b.disabled=true;}
}

/* ---------- Wallet update & transaction ---------- */
function changePoints(delta,cb){
  walletRef.transaction(cur=>{
    cur=+cur||0;
    if(cur+delta<0){showToast('‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶§ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏ ‡¶®‡ßá‡¶á');return;}   // ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏ ‡¶ï‡¶Æ ‡¶π‡¶≤‡ßá ‡¶¨‡ßç‡¶≤‡¶ï
    return cur+delta;
  },(err,committed,snap)=>{
    if(!err&&committed){
      wallet=snap.val();updWallet();
      if(cb) cb();
    }
  });
}

/* ---------- Place bet ---------- */
function place(i){
  if(phase!=='COUNT'||count<=20){showToast('‡¶¨‡ßá‡¶ü ‡¶è‡¶ñ‡¶® ‡¶¨‡¶®‡ßç‡¶ß');return;}
  const amt=+amtInputs[i].value,au=+autoInputs[i].value||0;
  if(!amt){showToast('‡¶è‡¶Æ‡¶® ‡¶ï‡ßã‡¶® ‡¶¨‡ßá‡¶ü ‡¶®‡ßá‡¶á');return;}
  if(amt<minBet){showToast(`‡¶Æ‡¶ø‡¶®‡¶ø‡¶Æ‡¶æ‡¶Æ ‡¶¨‡ßá‡¶ü ‡ß≥${minBet}`);return;}
  if(amt>maxBet){showToast(`‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡¶¨‡ßá‡¶ü ‡ß≥${maxBet}`);return;}

  changePoints(-amt,()=>{
    bets[i]={amt,auto:au,cashed:false};
    totalBet+=amt;curBet+=amt;
    betHist.textContent=`Total Cash‚Äëout: ‡ß≥${curCash} | Total Bet: ‡ß≥${curBet}`;
    lastAmt[i]=amt;lastAuto[i]=au;
    setBtn(i,'cancel');
    showToast(`‡¶¨‡ßá‡¶ü ‡¶™‡ßç‡¶≤‡ßá‡¶∏‡¶° ‡ß≥${amt}`);
    sendFeed({type:'bet',name:userName,amt});
  });
}

/* ---------- Update buttons each tick ---------- */
function updateBetButtons(){
  bets.forEach((b,idx)=>{
    if(!b.amt||b.cashed) return;
    if(count>20) setBtn(idx,'cancel');
    else         setBtn(idx,'wait');
  });
}

/* ---------- Crash pick (RTP) ---------- */
function pickCrash(){
  const curRTP=totalPaid/Math.max(totalBet,1);
  let c=rand(1,10);
  if(curRTP>targetRTP)c=Math.max(1,c-rand(0,2));
  else if(curRTP<targetRTP)c=Math.min(10,c+rand(0,2));
  return c.toFixed(2);
}

/* ---------- Feed fake data ---------- */
let betFeedTimer,cashFeedTimer;
function feedFakeBets(){
  let idx=0;
  betFeedTimer=setInterval(()=>{
    if(idx>=fakePlayers.length){clearInterval(betFeedTimer);return;}
    const p=fakePlayers[idx++];
    if(!p.betAdded){
      addEntry(playerTab,`${p.name} ‚Äî üé≤ Bet ‡ß≥${p.bet}`);
      p.betAdded=true;
    }
  },250);
}
function feedCashouts(){
  cashFeedTimer=setInterval(()=>{
    if(phase!=='FLY'){clearInterval(cashFeedTimer);return;}
    const p=fakePlayers.find(fp=>!fp.cash&&mult>=fp.target);
    if(p){
      p.cash=true;
      addEntry(playerTab,`${p.name} ‚Äî üí∞ ‡ß≥${Math.floor(p.bet*p.target)} @${p.target}x`,'win');
    }
  },250);
}

/* ---------- Round flow ---------- */
function startCountdown(){
  phase='COUNT';count=100;
  updateMultCountdown();
  genPlayers();curBet=curCash=0;
  betHist.textContent='Total Cash‚Äëout: ‡ß≥0 | Total Bet: ‡ß≥0';
  showToast('‡¶¨‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶≠‡¶æ‡¶á!');
  betBtns.forEach(b=>b.disabled=false);

  const iv=setInterval(()=>{
    count--;tLeft.textContent=(count/10).toFixed(1);
    updateMultCountdown();
    updateBetButtons();

    if(count===20)phase='LOCK';

    if(!count){
      clearInterval(iv);
      fly();
    }
  },100);
}

function fly(){
  phase='FLY';mult=1;
  multEl.textContent='x1.00';multEl.style.color='var(--accent)';
  plane.classList.add('bob');crashPt=pickCrash();
  startT=null;
  setTimeout(feedCashouts,1000);
  requestAnimationFrame(loop);
}

function loop(ts){
  if(!startT)startT=ts;
  const dt=(ts-startT)/1000;
  speed=dt<=2?0.1+dt/2*99:99;setSpeed(speed);
  mult+=0.02;multEl.textContent=`x${mult.toFixed(2)}`;
  plane.style.left=Math.min(mult*8,100)+'%';

  bets.forEach((b,i)=>{
    if(b.amt&&!b.cashed){
      setBtn(i,'live',Math.floor(b.amt*mult));
      if(b.auto&&mult>=b.auto){
        const win=Math.floor(b.amt*b.auto);
        changePoints(win);
        totalPaid+=win;curCash+=win;
        b.cashed=true;addEntry(myTab,`‚úÖ Cashed ‡ß≥${win} @${b.auto}x`,'win');
        betHist.textContent=`Total Cash‚Äëout: ‡ß≥${curCash} | Total Bet: ‡ß≥${curBet}`;
        showToast(`Auto cashed ‡ß≥${win}`);
        sendFeed({type:'cash',name:userName,win,mult:b.auto});
        setBtn(i,'done');b.amt=0;
      }
    }
  });
  if(mult>=crashPt){crash();return;}
  animId=requestAnimationFrame(loop);
}

function crash(){
  phase='CRASH';cancelAnimationFrame(animId);
  setSpeed(0);plane.classList.remove('bob');plane.classList.add('shake');
  clearInterval(cashFeedTimer);
  const boom=document.createElement('div');
  boom.className='boom';boom.textContent='üí•';
  document.getElementById('runway').appendChild(boom);
  setTimeout(()=>boom.remove(),600);
  multEl.textContent=`üí• ${mult.toFixed(2)}x`;multEl.style.color='var(--danger)';
  history.push(+mult.toFixed(2));if(history.length>20)history.shift();
  renderRes();

  fakePlayers.filter(p=>!p.cash).forEach(p=>addEntry(playerTab,`${p.name} ‚Äî ‚ùå Lost ‡ß≥${p.bet}`,'loss'));
  bets.forEach((b,i)=>{
    if(b.amt&&!b.cashed){
      addEntry(myTab,`‚ùå Lost ‡ß≥${b.amt} @${mult.toFixed(2)}x`,'loss');
      sendFeed({type:'lose',name:userName,amt:b.amt});
    }
    b.amt=b.auto=0;b.cashed=false;setBtn(i,'bet');
  });
  restoreInputs();
  setTimeout(feedFakeBets,1000);
  setTimeout(()=>{
    plane.className='plane';
    plane.style.left='0';
    startCountdown();
  },500);
}

/* ---------- Button click handling ---------- */
betBtns.forEach((b,i)=>b.onclick=()=>{
  if(phase==='FLY'&&bets[i].amt&&!bets[i].cashed){
    const win=Math.floor(bets[i].amt*mult);
    changePoints(win);
    totalPaid+=win;curCash+=win;addEntry(myTab,`‚úÖ Cashed ‡ß≥${win} @${mult.toFixed(2)}x`,'win');
    betHist.textContent=`Total Cash‚Äëout: ‡ß≥${curCash} | Total Bet: ‡ß≥${curBet}`;
    showToast(`Cashed ‡ß≥${win}`);
    sendFeed({type:'cash',name:userName,win,mult:+mult.toFixed(2)});
    bets[i].cashed=true;bets[i].amt=0;setBtn(i,'done');
    return;
  }
  if(phase==='COUNT'&&bets[i].amt&&!bets[i].cashed){
    if(count>20){
      changePoints(bets[i].amt);
      totalBet-=bets[i].amt;curBet-=bets[i].amt;
      betHist.textContent=`Total Cash‚Äëout: ‡ß≥${curCash} | Total Bet: ‡ß≥${curBet}`;
      showToast('‡¶¨‡ßá‡¶ü ‡¶ï‡ßç‡¶Ø‡¶æ‡¶®‡¶∏‡ßá‡¶≤ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá');
      bets[i].amt=bets[i].auto=0;bets[i].cashed=false;
      setBtn(i,'bet');
    }else showToast('‡¶¨‡ßá‡¶ü ‡¶è‡¶ñ‡¶® ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ');
    return;
  }
  place(i);
});

/* ---------- init ---------- */
renderRes();             // ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶æ‡¶•‡¶Æ‡¶ø‡¶ï ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞
// wallet & RTP Firebase‚Äë‡¶è‡¶∞ ‡¶≠‡ßç‡¶Ø‡¶æ‡¶≤‡ßÅ ‡¶≤‡ßã‡¶° ‡¶π‡¶≤‡ßá‡¶á ‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶≠‡¶æ‡¶¨‡ßá startCountdown() ‡¶π‡¶¨‡ßá
walletRef.once('value',()=>startCountdown());
}  // end initGame
</script>
</body>
</html>
