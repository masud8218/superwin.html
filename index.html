<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>SuperWin ‚Äì Crash Game</title>

<!-- FontAwesome icons -->
<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<!-- Firebase compat¬†SDK (ESM ‡¶ù‡¶æ‡¶Æ‡ßá‡¶≤‡¶æ ‡¶®‡ßá‡¶á) -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>

<style>
/* -----------  UI¬†CSS (‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã)  ----------- */
:root{--accent:#00ffcc;--danger:#ff4040;--bg:#1d2033}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif}
body{background:#0d0f1a;color:#fff;display:flex;flex-direction:column;align-items:center}
header{background:#1a1e2f;padding:12px 20px;display:flex;justify-content:space-between;align-items:center;border-bottom:2px solid #292c3f;width:100%;max-width:480px}
h1{font-size:22px;color:#00d4ff;display:flex;align-items:center;gap:6px}
.wallet{display:flex;align-items:center;gap:10px}
.wallet span{background:#2d3149;padding:6px 12px;border-radius:8px;font-size:14px}
.wallet button{background:#00d4ff;color:#000;border:none;padding:6px 10px;border-radius:8px;font-weight:600;cursor:pointer}
.result-wrap{position:relative;padding:8px 0;width:100%;max-width:480px}
.history-icon{position:absolute;right:12px;top:50%;transform:translateY(-50%);font-size:15px;cursor:pointer;color:#ccc}
.result-bar{display:flex;gap:6px;justify-content:flex-end;flex-direction:row-reverse}
.dropdown{margin-top:6px;display:none;flex-wrap:wrap;gap:6px;justify-content:flex-end;flex-direction:row-reverse;max-height:110px;overflow:auto}
.open .dropdown{display:flex}
.bubble{min-width:32px;padding:3px 6px;border-radius:6px;font-size:11px;font-weight:600;text-align:center}
.good{background:#28a745}.mid{background:#ffc107}.bad{background:#dc3545}
.card{width:95vw;max-width:480px;margin:0 auto;background:var(--bg);padding:18px;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,.4)}
.runway{position:relative;width:100%;height:80px;border-radius:12px;overflow:hidden;margin-bottom:12px}
.runway::before{content:"";position:absolute;inset:0;background:url('https://drive.google.com/uc?export=view&id=10oYzjF5-tJEY7rychqkg2rksF5n23XOz') center/200% 100% repeat-x;filter:brightness(.8);animation:bgmove 12s linear infinite}
@keyframes bgmove{to{background-position:-100% 0}}
.plane{position:absolute;left:0%;top:50%;transform:translateY(-50%);font-size:42px;filter:drop-shadow(0 0 6px var(--accent));transition:left .05s linear}
.bob{animation:bob .8s ease-in-out infinite}@keyframes bob{0%,100%{transform:translateY(-50%) translateY(-3px)}50%{transform:translateY(-50%) translateY(4px)}}
.shake{animation:shake .6s}@keyframes shake{10%,90%{transform:translateY(-50%) rotate(-4deg)}20%,80%{transform:translateY(-50%) rotate(4deg)}30%,70%{transform:translateY(-50%) rotate(-7deg)}40%,60%{transform:translateY(-50%) rotate(7deg)}50%{transform:translateY(-50%) rotate(0)}}
.boom{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-size:3rem;filter:drop-shadow(0 0 12px var(--danger));opacity:0;animation:boom .6s forwards}
@keyframes boom{0%{opacity:0;transform:translate(-50%,-50%) scale(.4)}50%{opacity:1;transform:translate(-50%,-50%) scale(1.3)}100%{opacity:0;transform:translate(-50%,-50%) scale(.2)}}
.mult{font-size:2.4rem;text-align:center;color:var(--accent);margin:4px 0;text-shadow:0 0 12px var(--accent)}
.speedBar{width:100%;height:16px;background:#222;border:2px solid #555;border-radius:10px;overflow:hidden;margin-bottom:6px}
.fill{width:0;height:100%;background:hsl(240,100%,55%);transition:width .1s linear,background .1s linear}
.bet-history{font-size:10px;margin-top:8px;text-align:center}
.timer{display:none}
.toast{position:fixed;left:50%;bottom:48px;transform:translateX(-50%) translateY(40px);background:#0d121e;border:2px solid #00d4ff;border-radius:10px;padding:10px 18px;opacity:0;pointer-events:none;font-size:14px;font-weight:600;transition:opacity .35s,transform .35s}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
@media(max-width:430px){.mult{font-size:1.9rem}.plane{font-size:34px}}
</style>
</head>
<body>

<!-- ==== UI ==== -->
<header>
  <h1><i class="fa-solid fa-plane-up"></i>&nbsp;SuperWin</h1>
  <div class="wallet">‡ß≥<span id="bal">0</span><button id="dep">Cancel</button></div>
</header>

<div class="result-wrap">
  <div class="history-icon" id="histToggle"><i class="fas fa-history"></i></div>
  <div class="result-bar" id="resBar"></div>
  <div class="dropdown" id="resDrop"></div>
</div>

<div class="card">
  <div class="runway" id="runway"><div class="plane" id="plane">‚úàÔ∏è</div></div>
  <div class="mult" id="mult">x1.00</div>
  <div class="speedBar"><div class="fill" id="fill"></div></div>
  <div class="bet-history" id="betHist">Total Cash‚Äëout: ‡ß≥0 | Total Bet: ‡ß≥0</div>
</div>

<div class="toast" id="toast">Loading...</div>

<!-- ==== SCRIPT ==== -->
<script>
/* ---------- Firebase Config (exact JSON ‡¶Æ‡¶æ‡¶®) ---------- */
const firebaseConfig = {
  apiKey: "AIzaSyDVaI_YjkGUrpzqZG6SqY6Y0VmO7SkK7ew",
  authDomain: "aviator-ultimate.firebaseapp.com",
  databaseURL: "https://aviator-ultimate-default-rtdb.firebaseio.com",
  projectId: "aviator-ultimate",
  storageBucket: "aviator-ultimate.firebasestorage.app",
  messagingSenderId: "1042964830702",
  appId: "1:1042964830702:android:775be0f28fa2e50a2316ff"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* ---------- Elements ---------- */
const plane=document.getElementById('plane'),multEl=document.getElementById('mult'),fill=document.getElementById('fill');
const resBar=document.getElementById('resBar'),resDrop=document.getElementById('resDrop');
const toast=document.getElementById('toast'),balEl=document.getElementById('bal');

/* ---------- State ---------- */
let uid='',wallet=0,history=[],mult=1,startT,animId,crashPt=2;
const rand=(a,b)=>Math.random()*(b-a)+a;
const hue=v=>240-(v/100)*240;
function setSpeed(v){fill.style.width=Math.min(v,100)+'%';fill.style.background=`hsl(${hue(v)},100%,55%)`;}
function show(msg,d=1500){toast.textContent=msg;toast.classList.add('show');setTimeout(()=>toast.classList.remove('show'),d);}
function renderRes(){
  resBar.innerHTML=resDrop.innerHTML='';
  history.slice(-8).forEach(v=>resBar.insertAdjacentHTML('beforeend',`<div class="bubble ${v>=4?'good':v>=2?'mid':'bad'}">${v}x</div>`));
  [...history].slice(-20).reverse().forEach(v=>resDrop.insertAdjacentHTML('beforeend',`<div class="bubble ${v>=4?'good':v>=2?'mid':'bad'}">${v}x</div>`));
}

/* ---------- Firebase login ---------- */
firebase.auth().signInAnonymously().then(res=>{
  uid=res.user.uid;
  db.ref('users/'+uid+'/points').once('value',s=>{
    wallet=s.exists()?s.val():5000;balEl.textContent=wallet;fly();
  });
});

/* ---------- Game core ---------- */
function fly(){
  mult=1;multEl.textContent='x1.00';multEl.style.color='var(--accent)';crashPt=(Math.random()*5+1.5).toFixed(2);
  plane.classList.add('bob');startT=null;requestAnimationFrame(loop);
}
function loop(ts){
  if(!startT)startT=ts;const dt=(ts-startT)/1000;setSpeed(dt<=2?0.1+dt/2*99:99);
  mult+=0.02;multEl.textContent=`x${mult.toFixed(2)}`;plane.style.left=Math.min(mult*8,100)+'%';
  if(mult>=crashPt){crash();return;}animId=requestAnimationFrame(loop);
}
function crash(){
  cancelAnimationFrame(animId);setSpeed(0);plane.classList.remove('bob');
  const boom=document.createElement('div');boom.className='boom';boom.textContent='üí•';
  document.getElementById('runway').appendChild(boom);setTimeout(()=>boom.remove(),600);
  multEl.textContent=`üí• ${mult.toFixed(2)}x`;multEl.style.color='var(--danger)';
  history.push(+mult.toFixed(2));if(history.length>20)history.shift();renderRes();db.ref('global/results').push(+mult.toFixed(2));
  setTimeout(()=>{plane.style.left='0';plane.className='plane';fly();},1500);
}

/* ---------- UI misc ---------- */
document.getElementById('histToggle').onclick=()=>document.querySelector('.result-wrap').classList.toggle('open');
renderRes();
show('Ready!');
</script>
</body>
</html>
